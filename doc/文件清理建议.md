# 项目文件清理建议

## 一、未使用/可删除的文件

### 1. 重复/备份文件（建议删除）

| 文件名 | 原因 | 建议 |
|--------|------|------|
| `3D-banana-all copy.py` | `3D-banana-all.py` 的副本 | ✅ 删除 |
| `generation_controller-备份.py` | `generation_controller.py` 的备份 | ✅ 删除 |
| `app.py` | 旧版本，已被 `app_new.py` 替代 | ✅ 删除 |
| `background-banana.py` | 与 `banana-background.py` 功能重复 | ⚠️ 确认后删除 |

### 2. 未被主流程引用的文件

| 文件名 | 分析 | 建议 |
|--------|------|------|
| `gate-合并.py` | 仅在文档中提及，未被代码引用 | ✅ 删除 |
| `koutu-1.py` | 独立工具脚本，不在主流程中 | ⚠️ 保留或移至 `scripts/` |
| `liblib-face.py` | 未被任何代码引用 | ✅ 删除 |
| `monitor_logs.py` | 独立监控工具 | ⚠️ 保留或移至 `scripts/` |

### 3. Jupyter Checkpoint 文件

| 目录 | 建议 |
|------|------|
| `.ipynb_checkpoints/` | ✅ 整个目录可删除（已在 .gitignore 中） |

---

## 二、测试文件分析

### 保留的测试文件（有持续价值）

| 文件名 | 用途 |
|--------|------|
| `test/test_matchers.py` | 核心匹配器测试 |
| `test/test_api.html` | API 接口测试页面 |
| `test/test_banned_words.py` | 违禁词检测测试 |
| `test/test_sensitive_content.py` | 敏感内容检测测试 |
| `test/test_comprehensive_compliance.py` | 综合合规测试 |
| `test/test_3d_compliance.py` | 3D 合规测试 |
| `test/test_start_generate.py` | 生成流程测试 |
| `test/test_gate_integration.py` | Gate 集成测试 |
| `test/test_head_selection.py` | 头像选择测试 |
| `test/test_head_with_content_agent.py` | 头像+内容代理测试 |

### 可删除的临时测试文件

| 文件名 | 原因 |
|--------|------|
| `test/test_quick_validation.py` | 临时验证脚本 |
| `test/test_clothing_extraction_fix.py` | 修复验证脚本（问题已解决） |
| `test/test_clothing_extraction_issue.py` | 问题诊断脚本（问题已解决） |
| `test/test_clothing_fix_verification.py` | 修复验证脚本（问题已解决） |
| `test/test_clothing_extraction.py` | 功能已合并到其他测试 |
| `test/test_clothing_completion_integration.py` | 临时集成测试 |
| `test/test_clothing_completion_logic.py` | 临时逻辑测试 |
| `test/test_optimized_completion.py` | 优化验证脚本 |
| `test/test_clip_english.py` | CLIP 实验脚本 |
| `test/test_clip_expression_only.py` | CLIP 实验脚本 |
| `test/test_clip_translated.py` | CLIP 实验脚本 |
| `test/test_keyword_vs_ai_comparison.py` | 对比实验脚本 |
| `test/test_gate_check_count.py` | Gate 计数测试（临时） |

### 根目录测试文件

| 文件名 | 建议 |
|--------|------|
| `test_banana_pro_img_jd.py` | ⚠️ 移至 `test/` 目录或删除 |

---

## 三、Shell 脚本状态

| 文件名 | 用途 | 建议 |
|--------|------|------|
| `check_deployment.sh` | 部署检查 | 保留 |
| `check_system.sh` | 系统检查 | 保留 |
| `deploy.sh` | 部署脚本 | 保留 |
| `create_backup.sh` | 备份脚本 | 保留 |
| `monitor.sh` | 监控脚本 | 保留 |
| `rebuild.sh` | 重建脚本 | 保留 |
| `start_backend.bat` | Windows 启动脚本 | 保留 |
| `start_frontend.bat` | Windows 启动脚本 | 保留 |

---

## 四、主流程使用的文件清单

### 核心应用文件
- `app_new.py` - 主应用入口
- `config.py` - 配置管理
- `content_agent.py` - 内容代理
- `generation_controller.py` - 生成控制器
- `image_processor.py` - 图片处理器

### Matcher 模块
- `matchers/base_matcher.py`
- `matchers/head_matcher.py`
- `matchers/body_matcher.py`

### 图片生成模块（通过 API 调用）
- `banana-clothes.py` - 服装处理
- `banana-hands.py` - 手拿物品处理
- `banana-hats.py` - 头戴物品处理
- `banana-background.py` - 背景处理
- `per-data.py` - 基础图片组合
- `gate-result.py` - Gate 检查

### API 调用的脚本
- `3D-banana-all.py` - 3D 渲染处理
- `background-jimeng4.py` - 即梦背景处理
- `banana-pro-img-jd.py` - 高级图像处理
- `runninghub-turn.py` - 角度变换（主）
- `liblib-turn.py` - 角度变换（备用）
- `upload2imgbed.py` - 图床上传

### 工具模块
- `utils/__init__.py`
- `utils/logger.py`
- `utils/response.py`
- `utils/module_loader.py`
- `utils/resource_manager.py`
- `utils/job_manager.py`
- 其他 utils 模块

---

## 五、清理命令

```powershell
# 1. 删除重复/备份文件
Remove-Item "3D-banana-all copy.py"
Remove-Item "generation_controller-备份.py"
Remove-Item "app.py"

# 2. 删除未使用文件
Remove-Item "gate-合并.py"
Remove-Item "liblib-face.py"

# 3. 删除临时测试文件
Remove-Item "test/test_quick_validation.py"
Remove-Item "test/test_clothing_extraction_fix.py"
Remove-Item "test/test_clothing_extraction_issue.py"
Remove-Item "test/test_clothing_fix_verification.py"
Remove-Item "test/test_clothing_extraction.py"
Remove-Item "test/test_clothing_completion_integration.py"
Remove-Item "test/test_clothing_completion_logic.py"
Remove-Item "test/test_optimized_completion.py"
Remove-Item "test/test_clip_english.py"
Remove-Item "test/test_clip_expression_only.py"
Remove-Item "test/test_clip_translated.py"
Remove-Item "test/test_keyword_vs_ai_comparison.py"
Remove-Item "test/test_gate_check_count.py"

# 4. 删除 Jupyter checkpoint
Remove-Item -Recurse -Force ".ipynb_checkpoints"

# 5. 移动根目录测试文件
Move-Item "test_banana_pro_img_jd.py" "test/"
```

---

## 六、确认结果

1. **`background-banana.py`** - 未被代码引用，可删除（主流程使用 `banana-background.py`）

2. **`变化角度.json`** - 未被代码引用，可删除

3. **`koutu-1.py` 和 `monitor_logs.py`** - 独立工具脚本，建议移至 `scripts/` 或删除

---

## 七、总结

### 可安全删除的文件（共 18 个）

**根目录（6 个）：**
- `3D-banana-all copy.py`
- `generation_controller-备份.py`
- `app.py`
- `background-banana.py`
- `gate-合并.py`
- `liblib-face.py`

**测试目录（12 个）：**
- `test/test_quick_validation.py`
- `test/test_clothing_extraction_fix.py`
- `test/test_clothing_extraction_issue.py`
- `test/test_clothing_fix_verification.py`
- `test/test_clothing_extraction.py`
- `test/test_clothing_completion_integration.py`
- `test/test_clothing_completion_logic.py`
- `test/test_optimized_completion.py`
- `test/test_clip_english.py`
- `test/test_clip_expression_only.py`
- `test/test_clip_translated.py`
- `test/test_keyword_vs_ai_comparison.py`

### 可选删除
- `变化角度.json`
- `test/test_gate_check_count.py`
- `.ipynb_checkpoints/` 目录

### 建议移动
- `koutu-1.py` → `scripts/`
- `monitor_logs.py` → `scripts/`
- `test_banana_pro_img_jd.py` → `test/`
