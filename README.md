# IP头像图片分析工具

这是一个使用GPT-4o分析IP头像图片的Python脚本，能够自动分析文件夹中的所有图片，并将分析结果保存到Excel文件中。

## 功能特点

- 自动读取指定文件夹中的所有图片文件
- 使用GPT-4o进行专业的图像分析
- 按照五个维度分析IP头像：眼睛形状、嘴型、表情、脸部动态、情感强度
- 将分析结果保存到Excel文件中，便于查看和处理

## 支持的图片格式

- JPG/JPEG
- PNG
- GIF
- BMP
- WEBP

## 安装依赖

在运行脚本之前，请先安装所需的Python包：

```bash
pip install -r requirements.txt
```

## 使用方法

### 方法一：直接运行脚本

```bash
python image_analyzer.py
```

运行后，脚本会提示您输入：
1. 图片文件夹路径
2. 输出Excel文件名（可选，默认为 analysis_results.xlsx）

### 方法二：在代码中使用

```python
from image_analyzer import ImageAnalyzer

# 创建分析器实例
analyzer = ImageAnalyzer()

# 分析指定文件夹中的图片
analyzer.analyze_folder("图片文件夹路径", "输出文件名.xlsx")
```

## 输出格式

分析结果将保存为Excel文件，包含以下列：

| 列名 | 说明 |
|------|------|
| 图片名 | 图片文件名 |
| 眼睛形状 | 眼睛的形状描述 |
| 嘴型 | 嘴部的形状描述 |
| 表情 | 整体表情描述 |
| 脸部动态 | 脸部动作或姿态 |
| 情感强度 | 情感表达的强烈程度 |
| 图片url地址 | 图片文件的完整路径 |

## 配置说明

脚本中已经预配置了OpenAI API的相关设置：

- API Key: `35f54cc4-be7a-4414-808e-f5f9f0194d4f`
- API Base URL: `http://gpt-proxy.jd.com/gateway/azure`
- 使用模型: `gpt-4o-0806`

如需修改这些配置，请编辑 `image_analyzer.py` 文件中的相应部分。

## 注意事项

1. 确保您有稳定的网络连接，因为需要调用OpenAI API
2. 图片文件较大时，分析可能需要更长时间
3. 如果分析失败，错误信息会显示在对应的分析结果列中
4. 建议在分析大量图片前先测试少量图片

## 错误处理

脚本包含完善的错误处理机制：

- 图片编码失败时会记录错误信息
- API调用失败时会显示具体错误原因
- 文件夹不存在或无权限时会给出提示
- Excel保存失败时会显示错误信息

## 示例

假设您有一个名为 `avatars` 的文件夹，包含多张IP头像图片：

```
avatars/
├── avatar1.jpg
├── avatar2.png
├── avatar3.gif
└── ...
```

运行脚本后，会生成类似以下的Excel文件：

| 图片名 | 眼睛形状 | 嘴型 | 表情 | 脸部动态 | 情感强度 | 图片url地址 |
|--------|----------|------|------|----------|----------|-------------|
| avatar1.jpg | 圆形大眼 | 微笑弧度 | 开心 | 正面直视 | 中等 | D:\avatars\avatar1.jpg |
| avatar2.png | 细长眼型 | 抿嘴 | 严肃 | 侧面转向 | 较强 | D:\avatars\avatar2.png |

## 技术支持

如果在使用过程中遇到问题，请检查：

1. Python版本是否为3.7或更高
2. 所有依赖包是否正确安装
3. 网络连接是否正常
4. 图片文件是否损坏或格式不支持